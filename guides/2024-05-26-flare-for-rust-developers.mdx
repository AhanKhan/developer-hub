---
slug: flare-for-rust-developers
title: Flare for Rust Developers
authors: [dineshpinto]
tags: [rust, quickstart, ethers-rs, solc]
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

This guide is for developers who want to interact with Flare using Rust. In this guide, using Rust, you will learn how to:

- Query a contract on Flare using [ethers-rs](https://github.com/gakonst/ethers-rs), an async library designed to interact with Ethereum-like chains.
- Compile a Solidity contract using [solc](https://github.com/ethereum/solidity), the Solidity compiler.

{/* truncate */}

## Getting started

### Installation

Install the Solidity compiler by following the instructions in the [Solidity documentation](https://docs.soliditylang.org/en/latest/installing-solidity.html#linux-packages).

For simplicity, the main commands are provided here:

<Tabs>
  <TabItem value="macos" label="MacOS via Homebrew" default>
    ```bash 
    brew tap ethereum/ethereum
    brew install solidity
    ```

  </TabItem>
  <TabItem value="ubuntu" label="Ubuntu via PPAs">
    ```bash 
    sudo add-apt-repository -y ppa:ethereum/ethereum
    sudo apt-get update
    sudo apt-get install solc
    ```
    
  </TabItem>
</Tabs>

Add this to your `Cargo.toml`:

```toml title="Cargo.toml"
[dependencies]
ethers = "2.0"
tokio = { version = "1.37.0", features = ["rt", "rt-multi-thread", "macros"] }
eyre = "0.6.12"
```

### Usage

You need to connect to testnet or mainnet via an RPC, any RPC listed on the [Network Configuration](../docs/flare/configuration#configuration) page will work. For this guide, you can use the Ankr RPC.

<Tabs groupId="network">
  <TabItem value="coston2" label="Coston2 Testnet" default>
    ```rust title="src/bin/chain_id.rs"
    use ethers::providers::{Middleware, Provider};
    use eyre::Result;

    #[tokio::main]
    async fn main() -> Result<()> {
        let provider = Provider::try_from("https://rpc.ankr.com/flare_coston2")?;
        let chain_id = provider.get_chainid().await?;
        println!("Chain ID: {}", chain_id); // Chain ID: 114
        Ok(())
    }
    ```
    </TabItem>
    <TabItem value="flare" label="Flare Mainnet">
    ```rust title="src/bin/chain_id.rs"
    use ethers::providers::{Middleware, Provider};
    use eyre::Result;

    #[tokio::main]
    async fn main() -> Result<()> {
        let provider = Provider::try_from("https://rpc.ankr.com/flare")?;
        let chain_id = provider.get_chainid().await?;
        println!("Chain ID: {}", chain_id); // Chain ID: 14
        Ok(())
    }
    ```

  </TabItem>
</Tabs>

```bash
cargo run --bin chain_id
```

## Query a contract

To query a contract, two pieces of information are required:

- Contract address
- Contract ABI (Application Binary Interface)

For this example, you can use the `FlareContractRegistry` contract which has the same address `0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019` across both testnet and mainnet.

### Fetch ABI

To fetch a contract's ABI, you can use Flarescan. Copy the **Contract ABI** from [Flarescan](https://flarescan.com/address/0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019/contract/14/code#abi), and paste it into a file named `FlareContractRegistry.json`, located in the root of your project, i.e. same level as `Cargo.toml`.

### Make query

You can query the `FlareContractRegistry` contract to get the addresses of other Flare contracts.

For example, querying it for the address of the `WNat` contract:

<Tabs groupId="network">
  <TabItem value="coston2" label="Coston2 Testnet" default>
    ```rust title="src/bin/make_query.rs"
    use std::sync::Arc;

    use ethers::{prelude::abigen, providers::Provider, types::Address};
    use eyre::Result;

    #[tokio::main]
    async fn main() -> Result<()> {
        let registry_addr: Address = "0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019".parse()?;
        let provider = Provider::try_from("https://rpc.ankr.com/flare_coston2")?;
        let client = Arc::new(provider);

        abigen!(FlareContractRegistry, "./FlareContractRegistry.json");
        let registry = FlareContractRegistry::new(registry_addr, client);

        if let Ok(wnat_addr) = registry
            .get_contract_address_by_name("WNat".to_string())
            .call()
            .await
        {
            println!("WNat address: {wnat_addr:?}");
            // WNat address: 0xc67dce33d7a8efa5ffeb961899c73fe01bce9273
        }
        Ok(())
    }
    ```

  </TabItem>
  <TabItem value="flare" label="Flare Mainnet">
    ```rust title="src/bin/make_query.rs"
    use std::sync::Arc;

    use ethers::{prelude::abigen, providers::Provider, types::Address};
    use eyre::Result;

    #[tokio::main]
    async fn main() -> Result<()> {
        let registry_addr: Address = "0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019".parse()?;
        let provider = Provider::try_from("https://rpc.ankr.com/flare")?;
        let client = Arc::new(provider);

        abigen!(FlareContractRegistry, "./FlareContractRegistry.json");
        let registry = FlareContractRegistry::new(registry_addr, client);

        if let Ok(wnat_addr) = registry
            .get_contract_address_by_name("WNat".to_string())
            .call()
            .await
        {
            println!("WNat address: {wnat_addr:?}");
            // WNat address: 0x1d80c49bbbcd1c0911346656b529df9e5c2f783d
        }
        Ok(())
    }
    ```

  </TabItem>
</Tabs>

```bash
cargo run --bin make_query
```

## Compiling a contract

For this example, you can write a simple Solidity contract to query the FTSOv2 feeds. You can reuse `FtsoV2FeedConsumer.sol` from the [FTSOv2 Sample Contract](../docs/ftso/getting-started#sample-contract). Copy the code, and save the `.sol` file in the same folder as your `Cargo.toml`.

:::info
Double check the addresses in `FtsoV2FeedConsumer.sol` to make sure it is the same as on the network you want to deploy your contract.

You can always query the `FlareContractRegistry` with key `FastUpdater` to get the address on that network:

```python
registry.get_contract_address_by_name("FastUpdater".to_string()).call().await
```

:::

### Compile with solc

To compile the contract, use the Solidity compiler:

```bash
solc --evm-version london --abi --bin FtsoV2FeedConsumer.sol -o build
```

The compiled contract will be saved in the `build/` folder.
