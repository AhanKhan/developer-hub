---
title: Read feeds onchain
tags: [intermediate, ftso, solidity]
slug: read-feeds-onchain
description: Read block-latency feeds using Solidity.
keywords: [solidity, ftso, oracle, flare-time-series-oracle, flare-network]
sidebar_position: 1
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";
import SetEvmVersionRemix from "/static/img/set-evm-version-remix.png";

This guide provides code examples demonstrating how to read FTSOv2 feeds off-chain. To read a block-latency feed on-chain, you need two key pieces of information:

1. **Contract Address:** The address for the `FastUpdater` contract varies by network. You can obtain this address by querying the `FlareContractRegistry` contract, which has the same address across all networks.

   FlareContractRegistry: `0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019`

2. **Feed Indexes:** The feeds you want to read are uniquely identified by their index. A list of feed indexes is provided on the [Block-Latency Feeds](../feeds) page.

:::info
If you are familiar with Hardhat or Foundry, use the [Hardhat and Foundry Starter Kit](/guides/hardhat-foundry-starter-kit) to get started with Flare development.
:::

<Tabs block>
    <TabItem value="flare" label="Flare Mainnet">
        ```solidity title="FtsoV2FeedConsumer.sol"
        // SPDX-License-Identifier: MIT
        pragma solidity <0.9.0;

        import { IFlareContractRegistry } from "@flarenetwork/flare-periphery-contracts/flare/util-contracts/userInterfaces/IFlareContractRegistry.sol";
        import { IFastUpdater } from "@flarenetwork/flare-periphery-contracts/flare/ftso/userInterfaces/IFastUpdater.sol";

        /**
        * THIS IS AN EXAMPLE CONTRACT USING HARDCODED VALUES.
        * DO NOT USE THIS CODE IN PRODUCTION.
        */

        contract FtsoV2FeedConsumer {
            IFastUpdater internal ftsoV2;
            // Feed indexes: 0 = FLR/USD, 2 = BTC/USD, 9 = ETH/USD
            uint256[] public feedIndexes = [0, 2, 9];

            constructor() {
                contractRegistry = IFlareContractRegistry(0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019);
                ftsoV2 = IFastUpdater(contractRegistry.getContractAddressByName("FastUpdater"));
            }

            /**
            * Get the current value of the feeds.
            */
            function getFtsoV2CurrentFeedValues()
                external
                view
                returns (
                    uint256[] memory _feedValues,
                    int8[] memory _decimals,
                    int64 _timestamp
                )
            {
                (
                    uint256[] memory feedValues,
                    int8[] memory decimals,
                    int64 timestamp
                ) = ftsoV2.fetchCurrentFeeds(feedIndexes);
                /* Your custom feed consumption logic. */
                /* In this example the feed values, decimals and last updated timestamp are just returned. */
                return (feedValues, decimals, timestamp);
            }
        }
        ```
    </TabItem>
    <TabItem value="coston2" label="Flare Testnet Coston2">
        ```solidity title="FtsoV2FeedConsumer.sol"
        // SPDX-License-Identifier: MIT
        pragma solidity <0.9.0;

        import { IFlareContractRegistry } from "@flarenetwork/flare-periphery-contracts/coston2/util-contracts/userInterfaces/IFlareContractRegistry.sol";
        import { IFastUpdater } from "@flarenetwork/flare-periphery-contracts/coston2/ftso/userInterfaces/IFastUpdater.sol";

        /**
        * THIS IS AN EXAMPLE CONTRACT USING HARDCODED VALUES.
        * DO NOT USE THIS CODE IN PRODUCTION.
        */

        contract FtsoV2FeedConsumer {
            IFastUpdater internal ftsoV2;
            // Feed indexes: 0 = FLR/USD, 2 = BTC/USD, 9 = ETH/USD
            uint256[] public feedIndexes = [0, 2, 9];

            constructor() {
                contractRegistry = IFlareContractRegistry(0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019);
                ftsoV2 = IFastUpdater(contractRegistry.getContractAddressByName("FastUpdater"));
            }

            /**
            * Get the current value of the feeds.
            */
            function getFtsoV2CurrentFeedValues()
                external
                view
                returns (
                    uint256[] memory _feedValues,
                    int8[] memory _decimals,
                    int64 _timestamp
                )
            {
                (
                    uint256[] memory feedValues,
                    int8[] memory decimals,
                    int64 timestamp
                ) = ftsoV2.fetchCurrentFeeds(feedIndexes);
                /* Your custom feed consumption logic. */
                /* In this example the feed values, decimals and last updated timestamp are just returned. */
                return (feedValues, decimals, timestamp);
            }
        }
        ```
    </TabItem>

</Tabs>

<br></br>

:::warning[When compiling and deploying the contract]

- **Using Remix:** Set EVM version to `london` in the **Advanced Configurations** section of the **Solidity Compiler** tab:

  <img src={SetEvmVersionRemix} style={{ width: 300 }} />

- **Using Standard Solidity JSON:** Set `evmVersion` to `london`:

  ```json
  {
    "settings": {
      "optimizer": {
        /* ... */
      },
      "evmVersion": "london"
    }
  }
  ```

- **Using `solc` CLI:** Set `--evm-version` to `london`:

  ```bash
  solc --evm-version london <args>
  ```

:::
